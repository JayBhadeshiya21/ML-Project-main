{% extends "base.html" %}

{% block title %}Predict Risk | CardioGuard{% endblock %}

{% block content %}
<section class="page-shell">
    <div class="container">
        <div class="row g-4 align-items-start">
            <div class="col-lg-4">
                <aside class="card ui-card sticky-panel p-4">
                    <span class="eyebrow"><i class="fa-solid fa-stethoscope"></i> Prediction Workspace</span>
                    <h3 class="mt-3 gradient-text">Submit Patient Metrics</h3>
                    <p class="text-muted mb-3">Complete each field accurately. The model evaluates your profile and returns a risk estimate in seconds.</p>
                    <div class="signal-box">
                        <i class="fa-solid fa-user-shield"></i>
                        <div>
                            <strong>Privacy Notice</strong>
                            <p class="mb-0">Input data is processed for inference and not stored.</p>
                        </div>
                    </div>
                </aside>
            </div>

            <div class="col-lg-8">
                <div class="card ui-card p-4 p-lg-5">
                    <h4 class="mb-4 gradient-text">Cardiovascular Input Form</h4>
                    <form id="predictionForm">
                        <h6 class="section-label">Demographics and Body Metrics</h6>
                        <div class="row g-3 mb-4">
                            <div class="col-md-6"><label for="age" class="form-label">Age (years)</label><input type="number" class="form-control" id="age" required min="10" max="100" placeholder="45"></div>
                            <div class="col-md-6"><label for="gender" class="form-label">Gender</label><select class="form-select" id="gender" required><option value="" selected disabled>Select...</option><option value="2">Male</option><option value="1">Female</option></select></div>
                            <div class="col-md-6"><label for="height" class="form-label">Height (cm)</label><input type="number" class="form-control" id="height" required min="50" max="250" placeholder="175"></div>
                            <div class="col-md-6"><label for="weight" class="form-label">Weight (kg)</label><input type="number" class="form-control" id="weight" required min="30" max="200" placeholder="70"></div>
                        </div>

                        <h6 class="section-label">Vitals and Lab Values</h6>
                        <div class="row g-3 mb-4">
                            <div class="col-md-6"><label for="ap_hi" class="form-label">Systolic BP</label><input type="number" class="form-control" id="ap_hi" required placeholder="120" min="60" max="250"></div>
                            <div class="col-md-6"><label for="ap_lo" class="form-label">Diastolic BP</label><input type="number" class="form-control" id="ap_lo" required placeholder="80" min="40" max="150"></div>
                            <div class="col-md-6"><label for="cholesterol" class="form-label">Cholesterol</label><select class="form-select" id="cholesterol" required><option value="1">Normal</option><option value="2">Above Normal</option><option value="3">Well Above Normal</option></select></div>
                            <div class="col-md-6"><label for="gluc" class="form-label">Glucose</label><select class="form-select" id="gluc" required><option value="1">Normal</option><option value="2">Above Normal</option><option value="3">Well Above Normal</option></select></div>
                        </div>

                        <h6 class="section-label">Lifestyle Indicators</h6>
                        <div class="row g-3 mb-4">
                            <div class="col-md-4"><label class="check-box-card"><input class="form-check-input" type="checkbox" id="smoke"><span>Smoker</span></label></div>
                            <div class="col-md-4"><label class="check-box-card"><input class="form-check-input" type="checkbox" id="alco"><span>Alcohol Intake</span></label></div>
                            <div class="col-md-4"><label class="check-box-card"><input class="form-check-input" type="checkbox" id="active" checked><span>Physically Active</span></label></div>
                        </div>

                        <button type="submit" class="btn btn-accent btn-lg w-100" id="predictBtn">Analyze Risk <i class="fa-solid fa-arrow-right ms-2"></i></button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</section>

<div class="modal fade" id="resultModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content border-0 rounded-4 shadow-lg text-center p-4">
            <div class="modal-body">
                <div id="loadingSpinner" class="d-none">
                    <div class="spinner-border text-primary" role="status"><span class="visually-hidden">Loading...</span></div>
                    <p class="mt-3 text-muted">Analyzing your data...</p>
                </div>

                <div id="resultContent" class="d-none">
                    <div class="mb-3" id="iconContainer"></div>
                    <h2 class="fw-bold mb-2" id="resultTitle">Result</h2>
                    <p class="lead mb-4" id="resultMessage">Message</p>

                    <div class="alert alert-warning border-0 shadow-sm text-start small d-flex align-items-start">
                        <i class="fa-solid fa-circle-exclamation text-danger me-2 mt-1"></i>
                        <div>
                            <strong>MEDICAL DISCLAIMER:</strong> This tool is for educational use only.
                            Model accuracy is around <span class="badge bg-danger text-white">73%</span>.
                            It does not replace professional diagnosis.
                        </div>
                    </div>

                    <button type="button" class="btn btn-outline-secondary rounded-pill px-4 mt-2" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/script.js') }}"></script>
{% endblock %}
